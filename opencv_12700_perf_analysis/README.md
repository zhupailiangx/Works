## Houghlines ()
### Houghlines测试结果

<table border=0 cellpadding=0 cellspacing=0 width=507 style='border-collapse:
 collapse;table-layout:fixed;width:380pt'>
 <col width=64 span=2 style='width:48pt'>
 <col width=187 style='mso-width-source:userset;mso-width-alt:6838;width:140pt'>
 <col width=64 span=3 style='width:48pt'>
 <tr height=20 style='height:15.0pt'>
  <td colspan=2 height=20 class=xl65 width=128 align=center style='height:15.0pt;width:96pt'>Linux</td>
  <td colspan=2 class=xl65 width=251 align=center style='border-left:none;width:188pt'>Linux
  (add Timestamp)</td>
  <td colspan=2 class=xl66 align=center width=128 style='border-right:.5pt solid black;
  border-left:none;width:96pt'>Windows</td>
 </tr>
 <tr height=20 style='height:15.0pt'>
  <td height=20 class=xl65 align=center style='height:15.0pt;border-top:none'>P</td>
  <td class=xl65 style='border-top:none;border-left:none'>E</td>
  <td class=xl65 style='border-top:none;border-left:none'>P</td>
  <td class=xl65 style='border-top:none;border-left:none'>E</td>
  <td class=xl65 style='border-top:none;border-left:none'>P</td>
  <td class=xl65 style='border-top:none;border-left:none'>E</td>
 </tr>
 <tr height=20 style='height:15.0pt'>
  <td height=20 class=xl65 align=center style='height:15.0pt;border-top:none'>0.45 ms</td>
  <td class=xl65 style='border-top:none;border-left:none'>0.44 ms</td>
  <td class=xl65 style='border-top:none;border-left:none'>3.12ms</td>
  <td class=xl65 style='border-top:none;border-left:none'>5.05ms</td>
  <td class=xl65 style='border-top:none;border-left:none'>0.22ms</td>
  <td class=xl65 style='border-top:none;border-left:none'>0.37ms</td>
 </tr>
 <![if supportMisalignedColumns]>
 <tr height=0 style='display:none'>
  <td width=64 style='width:48pt'></td>
  <td width=64 style='width:48pt'></td>
  <td width=187 style='width:140pt'></td>
  <td width=64 style='width:48pt'></td>
  <td width=64 style='width:48pt'></td>
  <td width=64 style='width:48pt'></td>
 </tr>
 <![endif]>
</table>

</body>

### Add Timestamp
<table border=0 cellpadding=0 cellspacing=0 width=723 style='border-collapse:
 collapse;table-layout:fixed;width:543pt'>
 <col width=64 style='width:48pt'>
 <col width=83 style='mso-width-source:userset;mso-width-alt:3035;width:62pt'>
 <col width=64 style='width:48pt'>
 <col width=98 style='mso-width-source:userset;mso-width-alt:3584;width:74pt'>
 <col width=222 style='mso-width-source:userset;mso-width-alt:8118;width:167pt'>
 <col width=64 span=3 style='width:48pt'>
 <tr height=20 style='height:15.0pt'>
  <td height=20 colspan=4 width=309 style='height:15.0pt;mso-ignore:colspan;
  width:232pt'>(1920x1080, 32FC3, INTER_LINEAR)</td>
  <td width=222 style='width:167pt'>(3840x2160, 32FC3, INTER_LINEAR)</td>
  <td width=64 style='width:48pt'></td>
  <td width=64 style='width:48pt'></td>
  <td width=64 style='width:48pt'></td>
 </tr>
 <tr height=20 style='height:15.0pt'>
  <td colspan=2 height=20 class=xl66 style='height:15.0pt'>Linux</td>
  <td colspan=2 class=xl66 style='border-left:none'>Linux (add Timestamp)</td>
  <td colspan=2 class=xl66 style='border-left:none'>Linux</td>
  <td colspan=2 class=xl66 style='border-left:none'>Linux (add Timestamp)</td>
 </tr>
 <tr height=20 style='height:15.0pt'>
  <td height=20 class=xl66 style='height:15.0pt;border-top:none'>P</td>
  <td class=xl66 style='border-top:none;border-left:none'>E</td>
  <td class=xl66 style='border-top:none;border-left:none'>P</td>
  <td class=xl66 style='border-top:none;border-left:none'>E</td>
  <td class=xl66 style='border-top:none;border-left:none'>P</td>
  <td class=xl66 style='border-top:none;border-left:none'>E</td>
  <td class=xl66 style='border-top:none;border-left:none'>P</td>
  <td class=xl66 style='border-top:none;border-left:none'>E</td>
 </tr>
 <tr height=20 style='height:15.0pt'>
  <td height=20 class=xl66 style='height:15.0pt;border-top:none'>&nbsp;</td>
  <td class=xl66 style='border-top:none;border-left:none'>&nbsp;</td>
  <td class=xl66 style='border-top:none;border-left:none'>27</td>
  <td class=xl66 style='border-top:none;border-left:none'>31</td>
  <td class=xl66 style='border-top:none;border-left:none'>&nbsp;</td>
  <td class=xl66 style='border-top:none;border-left:none'>&nbsp;</td>
  <td class=xl66 style='border-top:none;border-left:none'>118</td>
  <td class=xl66 style='border-top:none;border-left:none'>128</td>
 </tr>
 <![if supportMisalignedColumns]>
 <tr height=0 style='display:none'>
  <td width=64 style='width:48pt'></td>
  <td width=83 style='width:62pt'></td>
  <td width=64 style='width:48pt'></td>
  <td width=98 style='width:74pt'></td>
  <td width=222 style='width:167pt'></td>
  <td width=64 style='width:48pt'></td>
  <td width=64 style='width:48pt'></td>
  <td width=64 style='width:48pt'></td>
 </tr>
 <![endif]>
</table>

</body>


‪opencv-4.8.0\modules\imgproc\src\hough.cpp 187行for 循环加入时间戳
```
for( i = 0; i < height; i++ )
        for( j = 0; j < width; j++ )
        {
            if( image[i * step + j] != 0 )
                for(int n = 0; n < numangle; n++ )
                {
                    
                    int r = cvRound( j * tabCos[n] + i * tabSin[n] );
                    
                    r += (numrho - 1) / 2;

                    auto start6 = std::chrono::high_resolution_clock::now();//add

                    accum[(n+1) * (numrho+2) + r+1]++;

                    auto end6 = std::chrono::high_resolution_clock::now();//add
                    std::chrono::duration<double, std::milli> tm6 = end6 - start6; //add
                    tt += tm6.count(); //add
                }
        }

```
## warpaffine
<table border=0 cellpadding=0 cellspacing=0 width=723 style='border-collapse:
 collapse;table-layout:fixed;width:543pt'>
 <col width=64 style='width:48pt'>
 <col width=83 style='mso-width-source:userset;mso-width-alt:3035;width:62pt'>
 <col width=64 style='width:48pt'>
 <col width=98 style='mso-width-source:userset;mso-width-alt:3584;width:74pt'>
 <col width=222 style='mso-width-source:userset;mso-width-alt:8118;width:167pt'>
 <col width=64 span=3 style='width:48pt'>
 <tr height=20 style='height:15.0pt'>
  <td height=20 colspan=4 width=309 style='height:15.0pt;mso-ignore:colspan;
  width:232pt'>(1920x1080, 32FC3, INTER_LINEAR)</td>
  <td width=222 style='width:167pt'>(3840x2160, 32FC3, INTER_LINEAR)</td>
  <td width=64 style='width:48pt'></td>
  <td width=64 style='width:48pt'></td>
  <td width=64 style='width:48pt'></td>
 </tr>
 <tr height=20 style='height:15.0pt'>
  <td colspan=2 height=20 class=xl66 style='height:15.0pt'>Linux</td>
  <td colspan=2 class=xl66 style='border-left:none'>Linux (add Timestamp)</td>
  <td colspan=2 class=xl66 style='border-left:none'>Linux</td>
  <td colspan=2 class=xl66 style='border-left:none'>Linux (add Timestamp)</td>
 </tr>
 <tr height=20 style='height:15.0pt'>
  <td height=20 class=xl66 style='height:15.0pt;border-top:none'>P</td>
  <td class=xl66 style='border-top:none;border-left:none'>E</td>
  <td class=xl66 style='border-top:none;border-left:none'>P</td>
  <td class=xl66 style='border-top:none;border-left:none'>E</td>
  <td class=xl66 style='border-top:none;border-left:none'>P</td>
  <td class=xl66 style='border-top:none;border-left:none'>E</td>
  <td class=xl66 style='border-top:none;border-left:none'>P</td>
  <td class=xl66 style='border-top:none;border-left:none'>E</td>
 </tr>
 <tr height=20 style='height:15.0pt'>
  <td height=20 class=xl66 style='height:15.0pt;border-top:none'>&nbsp;</td>
  <td class=xl66 style='border-top:none;border-left:none'>&nbsp;</td>
  <td class=xl66 style='border-top:none;border-left:none'>27</td>
  <td class=xl66 style='border-top:none;border-left:none'>31</td>
  <td class=xl66 style='border-top:none;border-left:none'>&nbsp;</td>
  <td class=xl66 style='border-top:none;border-left:none'>&nbsp;</td>
  <td class=xl66 style='border-top:none;border-left:none'>118</td>
  <td class=xl66 style='border-top:none;border-left:none'>128</td>
 </tr>
 <![if supportMisalignedColumns]>
 <tr height=0 style='display:none'>
  <td width=64 style='width:48pt'></td>
  <td width=83 style='width:62pt'></td>
  <td width=64 style='width:48pt'></td>
  <td width=98 style='width:74pt'></td>
  <td width=222 style='width:167pt'></td>
  <td width=64 style='width:48pt'></td>
  <td width=64 style='width:48pt'></td>
  <td width=64 style='width:48pt'></td>
 </tr>
 <![endif]>
</table>

</body>

### 时间戳
‪opencv-4.8.0\modules\imgproc\src\imgwarp.cpp 1200行加时间戳增加负载
```
  #if CV_SIMD128
                        {
                            v_uint16x8 v_scale = v_setall_u16(INTER_TAB_SIZE2 - 1);
                            int span = v_uint16x8::nlanes;
                            for (; x1 <= bcols - span; x1 += span) {
                                auto start0 = std::chrono::high_resolution_clock::now();//add
                                v_store((unsigned short*)(A + x1), v_load(sA + x1) & v_scale);
                                auto end0 = std::chrono::high_resolution_clock::now();//add
                                std::chrono::duration<double, std::nano> tm123 = end0 - start0;//add
                                t_remap += tm123.count();//add

                                //count_remapinvoker += 1;
                                //std::cout << "count_remapinvoker :" << count_remapinvoker << std::endl;
                            }
                        }
                        #endif
```
### 总结
1. Windows 在cvRound 函数中使用了SIMD 所以比Linux快。
2.  Linux 上该算子的负载较低，P 核和E 核上该算子的性能相近，可以看到加入了计时代码，性能就有了差距。

## Windows E core
![image](https://github.com/zhupailiangx/Works/assets/120553507/27507c6b-a4bc-4ab2-8211-3d8ecf2f8a38)

## Windows P core
![image](https://github.com/zhupailiangx/Works/assets/120553507/206bb5b0-16bc-4eb9-a31c-0311c9bce32c)

